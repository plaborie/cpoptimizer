While we understand that the previous version of the paper was
rejected with encouragement to resubmit, we have included our
responses to the reviewers' comments in case this makes the subsequent
round of reviewing easier.

We would like to thank all the reviewers for their constructive and 
relevant comments. We have tried to consider all reviewers' 
comments. The major changes in the current submission can 
be summarized as follows:

1) The complexity proof of the static problem is completely different and corrected.
2) Two new constraint programming models are added and experimented with.
3) The scheduling models are improved.
4) All the experiments are repeated using the recent version of the 
commercial solvers.
5) New analysis of experimental results, specifically on the dynamic problem, 
is provided.  
6) The Discussion section is improved to address the limitations of our solution 
approach. 

Our detailed responses to each of reviewers' comments are provided below.
-----------------------------------------------------------------------------
Reviewer #1:
Comments and suggestions
========================
The article is an extension of the author's ICAPS-2011 paper on scheduling 
an aircraft repair shop. 
The following extensions are provided:
- A complexity proof of NP-completeness of the problem
- The dynamic version of the problem is introduced together 
  with some approaches to handle it 
- The experimental section is extended to handle the dynamic 
  version of the problem

The problem is challenging as it mixes allocation decisions 
(allocation of aircrafts to waves) and detailed scheduling 
(scheduling of repair activities in the shop) in a dynamic and uncertain 
environment.

The proposed logic-based Benders decomposition is very judicious as 
it exploits the limited correlation between the two types of decision 
variables in the problem. The Benders cuts are very interesting.

1) Could you give a little bit more precisions in the article on how 
the CP (sub)problems are modeled and solved. Both for the case the 
master sub-problem uses CP and for the scheduling problem. 

RESPONSE: We have described the CP models in detail in 
          sections 3.2.2 and 3.2.3.

2) In particular, did you try some more recent CP solvers than Solver/Scheduler. 
I would expect that the advanced techniques used for instance in CP Optimizer 
can improve the performance of CP particularly for solving the master problem 
(the scheduling sub-problem seems to be easier).

RESPONSE: In the new version of the paper, we have used the recent versions of the 
          commercial solvers. We have used CP Optimizer 12.3 for our CP models and 
          Cplex 12.3 for our MIP models. The details are provided in the paper.  

The static version of the problem does not take into account the planes that 
participate into a flight and re-enter the repair shop because they did not 
pass a subsequent check. This explains why it is not really interesting to 
schedule too many waves in advance because for waves too far in the future, the 
repair shop will be in the reality much more loaded than what it is in the 
current static approach. 

3) Did you investigate or have some ideas about how the static approach 
could be extended to better handle this stochastic flow of new aircrafts 
entering the repair shop? Could that be handled by somehow leaving some 
availability slack on the repair resources for future waves?

RESPONSE: We have discussed some ideas for better modeling the
          uncertainty about the aircraft failures in section 5,
          "Discussion section". Leaving some slack on resource
          to make a schedule more robust is indeed an interesting
          direction that has had only a bit of work in the
          scheduling literature (e.g., Branke and Mattfeld [11, 12]). Much of our
          subsequent work on combining maintenance and scheduling (not
          yet published) has looked at principled ways to make use of
          long-term stochastic models to influence the definition of
          optimality for the scheduling problem. We note this
          direction in our Discussion.

4) I think there is a flaw in the proof of the NP-completeness of the problem: 
activities of processing time xi and resource requirement yi cannot be 
considered as a rectangle of size (xi,yi) in a 2D knapsack because each unit 
of capacity in [1,yi] does not have to be allocated to "contiguous" resources. 
It is well known that the "scheduling" problem is less constrained than the 
2D packing. This being said, it is clear that the considered problem is 
NP-complete and a more direct problem related with it is the 
"Multiprocessor scheduling problem" (referenced SS8 in Garey-Johnson's 
Guide to the Theory of NP-Completeness). I think this should be fixed in 
the published version.

RESPONSE: The point problem by the reviewer is valid. We have followed
	  the suggestion and now present a new proof of complexity
	  reducing from a single machine scheduling problem.
          
5) In the section about experiments, is the selected problem size 
(number of aircrafts in [10,30]) representative of the real problems? 
If real problems are larger one may need to sacrifice optimality proofs 
and focus on providing good quality solutions. In this context, it would
be useful in the experiments to also study the objective value of the best 
solutions found by the different approaches on larger problems 
(not necessarily proved to be optimal).

RESPONSE: The size of the problem instances in the paper are 1.5 times
          bigger than the problems in the real application studied in
          Safaei et al [43]. The details are now provided in section
          4.1.1.
          
          Some analysis on the best solution found is provided in
          section 4.1.2 comparing the pure CP and MIP.

Some more detailed remarks:

6) p3: in the description of the problem, when introducing set Ik it would help 
to precise that aircrafts of set Ik are the ones initially in the repair shop at t=0.

RESPONSE: A clearer description of $I_k$ is provided in section 2.1
          ("Problem Definition").  $I_k$ is the set of aircraft of
          type $k$ and $\eta_k$ is the number of aircraft of type $k$
          at $t=0$ in the repair shop.

7) p5, section 3.1: in the reduced problem, the first wave is supposed to require 
all m aircrafts, right?

RESPONSE: The proof for the NP-hardness has changed. In the new proof,
          it is stated that the first wave requires all the aircraft.

8) p6, table 1: it should be made clear that the ith due date assigned to job j 
is the start time of the ith wave (ordered by increasing due dates)

RESPONSE: Done. Please see section 3.2.1.

9) p11: I find policy P33 has a very limited interest. It should be clear that it is 
always inferior to P13 as it will re-inject in the repair shop the aircrafts 
failing in the first two waves only when the problem is rescheduled. It's only 
interest is to re-schedule less often.

RESPONSE: We agree. The main point of having $P_{33}$ in the paper is
          to have a clear and fair comparison between longer
          scheduling horizon in $P_{33}$ and more frequent
          rescheduling in $P_{11}$ policy.


10) p16: you mention that "if the number of available aircraft is more than the requirements,
the aircraft that fly are randomly selected from those that passed the pre-flight check". 
Does it really work like that in practice? Are all the available aircrafts 
systematically checked before each wave or only a subset of them until the 
desired number is reached?

RESPONSE: We have added a paragraph in section 4.2.1 ("Experimental Setup") 
          to make our assumption clear.          
------------------------------------------------------------------------------------------------
Reviewer #2:

Review: This paper describes different approaches in solving dynamic repair shop 
scheduling problem for military aircraft fleet management.
The techniques are interesting and novel for this type of problem, the
empirical evaluation is quite thorough, and the paper is reasonably well
written. I also like the fact that it¹s compact, concise, and easy to read.

However, the current version of the paper can be improved in
several areas: (1) better motivation; (2) improve the readability of the 
core encoding description; and (3) empirical evaluation section. Those
improvements are not major, but addressing them will improve the 
final version. I will elaborate on each point below.
 
1) First, I believe people who will benefit most from this work
are: (1) the ones who work on other dynamic repair shop scheduling problem
in general who can borrow some techniques from this work to adapt to their
problem; and (2) people who need to do military aircraft fleet management. For the
first type of users, while the authors mentioned potential industries such as
railroad and airline and also the related work section point to similar
problems/techniques; I think it would help if the authors can make it more
explicit that this particular set of constraints address in this work
capture the core constraints of many realistic applications (if there are some
concrete citations, that would be great too). 

RESPONSE: The first paragraph of the "Introduction" section is changed 
          considering the reviewer's comment.
          
2) For the second type of users who can use the results in this paper directly, 
it would be useful to specify how realistic the set of test problems used are. 
Right now, it seems to me that a lot of parameters are selected or generated 
randomly and realistic problem sets are normally not random. Therefore, 
to make the work more compelling for this type of users, it is helpful to 
state how the test problems are representative of the real problem set.

RESPONSE: It has been made clear in section 4.1.1 ("Experimental Setup") 
          that the experimental setup includes the numerical examples of 
          Safaei et al.[43] which are based on real data.
 
3) Second, while I like the fact that the paper is short and
compact, it seems that many parts are taken from a conference version and
thus the authors do not take full advantage of the no-page-limit format of the
journal paper to improve the readability of the paper. The part that I
think can be improved the most is Section 3.2.1 (including Figure 3) on the core
MIP encoding. When reading this section, I found myself constantly flipping
between page 6 and page 3 to find the description of different variables. I suggest
extending Table 1 to include all variables and short descriptions about
them (even if they are already explained in page 3). The second paragraph
explaining different constraints can be itemized with one item for each constraint,
some of them deserve longer explanation too (some details below). I also suggest
ordering the constraints or their descriptions so that they follow in
sequence. For example, constraint #5 is currently explained before equation #2.

RESPONSE: Done. Please see section 3.2.1, "Mixed Integer Programming".
 
Third, while the empirical evaluation is thorough, it can be
improved a little bit. Besides the mentioned explanation on how realistic
the problem set was generated, my main concerns are: 

4) (1) reasons for the discrepancies between parameters used to generate 
the scheduling and rescheduling problem sets (e.g., failure rate of [0,0.1] 
in scheduling and [0,0.5] in rescheduling); 

RESPONSE: In the new version of the paper, the failure rate of [0,0.5] 
          is considered in both scheduling and rescheduling. 
          
5) (2) no time comparison between P11, P31, and P33 which can lead to 
incomplete comparison picture between those three choices.
Thus, P31 seems much better than the other two on coverage, but it should
take more solving time than P11 and P33 and can go over the time limit more
frequently if the problem size increases; 

RESPONSE: Time comparison results are now provided. Please see section 4.2.2. 

6) (3) is it better to separate Figure 8 into three different figures 
for P11, P31, P33 instead of grouping them given the fact that those 
three behaves differently? 

RESPONSE: Done.

7) (4) Figure 12 seems to indicates that P11 is (almost) always better 
than P33 even if the failure rate is low ([0,0.1]). If that¹s the case, 
why don¹t you just say so instead of saying that only for ³when the failure 
rate is stochastically high²?

RESPONSE: We agree that the comparison results between $P_{11}$ and
          $P_{33}$ were not so clear. In the new version of the paper,
          the previous figure is removed. We have provided a
          discussion on "The impact of longer scheduling horizon
          vs. more frequent rescheduling" in section 4.2.2.
           
Other comments:

8) 1.Related work: There is a recent paper on ³Anticipatory Online Planning² by 
Burns et al. at ICAPS¹12 that proposes to use hindsight optimization to anticipate 
possible future events to plan for them accordingly. There are similarities 
between future goals in that work and possible future aircraft failures in 
the dynamic scheduling problem addressed here. I think hindsight 
optimization can possibly be another way attractive approach to scale up to 
longer horizon when solving this dynamic scheduling Problem.  

RESPONSE: In section 6, "Discussion", we have referred to hindsight 
          optimization to be investigated in future work as a possible approach 
          to better handle the uncertainty about the aircraft failures.

9) 2.Required number of aircrafts for each wave: it¹s not clear to me 
at the beginning that this is a soft and not a hard constraint and
actually it¹s the upper-bound on the number of aircraft of each type that
can be assigned to each wave (as the constraint #5 implies). Therefore,
³required² may not be the right word to describe this number.

RESPONSE: Done. We have made appropriate changes in different 
          sections to make it clear that $a_{kw}$ is the 
          maximum number of aircraft type $k$ required by 
          wave $w$.

10) 3.It would be useful to mention explicitly that pre-flight and 
post-flight checks are both ³instantaneous² and cost 0. If checks 
have significant costs, then the advantage of having more aircrafts
available earlier (discussion in page 18) decreases. BTW, are those
assumptions Realistic?

RESPONSE: Done. In section 2.1, "Problem Definition", we have 
          made it clear that the checks have negligible cost
          and the time of each check can be added to the length 
          of corresponding flight. 
          
          We believe that the regulations in military applications require 
          some type of pre- and post-flight checks. Therefore, the fixed cost of 
          establishing the checks has already paid and we have assumed that 
          the variable cost of checking each aircraft individually is 
          negligible. 

11) 4.I¹m not sure what the failure rate \lambda = X with 0 < X < \infty means. 
Does it mean that a given aircraft expects to fail X times during its lifetime?

RESPONSE: We have added a sentence to make the meaning of the failure rate 
          clear when defining it for the first time. Please see section 
          2.1, "Problem Definition".

12) 5.Section 3.2.5: First, regarding the condition (2) on ³without removing 
any globally optimal assignments², should it be a weaker condition of ³without 
removing all globally optimal assignment². As long as at least one globally 
optimal solution still not gets pruned, the algorithm is still globally 
optimal-guarantee, right? 

RESPONSE: The condition (2) is stated as one of the necessary and
          sufficient conditions for proving the validity of the
          Benders cut in the paper by Chu and Xia (CPAIOR
          2004)[14]. So, we are following the literature. We believe
          that the reviewer's argument has merit if one is willing to
          give up true completeness. This is an interesting area for
          future work on Benders.
          
13) Second, the cut doesn¹t seem to cut not only any globally optimal solution, 
but any feasible solution. If that the case, should it be stated like that 
to avoid giving any possible wrong interpretation that it doesn¹t remove any 
globally optimal solution but can remove some feasible solution?

RESPONSE: The Benders approach searches in infeasible space since some
          of the constraints are relaxed in the master problem. The
          standard form of a cut places an upper bound (assuming a
          maximization problem) on the objective function, obj <= A,
          where A depends on the bound derived in the subproblem and a
          subset of decision variables (say the minimum value given by
          A ends up being c*). No globally feasible solutions are
          removed, therefore, because if the master problem finds a
          feasible master solution with obj <= c*, then the cut is
          trivially satisfied: it will only remove solutions with a
          cost greater than c* because they have been proved
          infeasible.

14) 6.Page 14: the column ³%Unsolved² is misleading. What I believe you 
actually mean is ³% Optimal solution found² because the Incomplete & Hybrid 
approach clearly ³solved² all of them. 

RESPONSE: Fixed.

15) Moreover, the discussion on the incomplete approach of using dispatching 
heuristic gives the impression that it¹s not good when it can solve all 
but can¹t prove optimality for many problems (citing ³industries with 
expensive assets²). However, I think this is misleading because finding some 
solution is better than not finding any solution. Therefore, when all other 
approaches can not find a solution when timing out (all of them leave at 
least 11.90% problems unsolved), you may want to use this dispatching 
heuristic to quickly find one. Moreover, there are industries that may not 
use expensive assets and there are scenarios in which long solving time 
actually incurs additional overall cost. Those situations may favor quick 
approach like using dispatching heuristic. For example, spending 7200 seconds 
using MIP instead of 0.01 seconds using dispatching heuristics to solve a 
given problem will delay all other processes (repair, check, assigning 
aircrafts to waves etc.) by 2 hours and can lead to worse solutions.
 
RESPONSE: Done. Please see "Incomplete and Hybrid Approaches" part 
          in section 4.1.2.

Minor comments:

16) 1.Font in Figure 2 is too small. This figure can be made bigger.

RESPONSE: Fixed.

17) 2.Page 6: some intuition for B is needed when it first introduced.

RESPONSE: Done. Please see section 3.2.1.

18) 3.Page 6: increase the font size of Table 1.

RESPONSE: Fixed.

19) 4.Page 6: ³all aircraft² -> ³all aircrafts²

RESPONSE: The plural form of aircraft is also "aircraft".

20) 5.Page 6: ³Equation (4) calculates the expectation² -> 
³Equation (4) calculates the expected number of aircrafts²

RESPONSE: Changed.

21) 6.Page 7, equation #2: d_i (ith due date) was not introduced before.

RESPONSE: Fixed. Please see section 3.2.1.

22) 7.Page 7, equation #4: I don¹t understand why w != k.

RESPONSE: We meant that $\forall w, (w\neq 1), \forall k$. In the new 
          version of the paper, we have presented equation #4 more clearly 
          to avoid possible confusion. 

23) 8.Page 8, I^r_{jh}: why not using I^h_{rj} because h is used as 
superscript in other places.

RESPONSE: Changed.

24) 9. Page 8, CP Model: please provide some reasons/motivations why you
also want to try the CP model besides the MIP model. Is it because this model 
has worked well for related problems?

RESPONSE: Done. Please see section 3.2.2. 

25) 10. Page 8-9: constraint #17 is quite cryptic and I still do not really 
understand it from the description in page 9. Could you write this constraint 
in a more self-explanatory way?

RESPONSE: Fixed. Please see sections 3.2.2 and 3.2.3.

26) 11. Page 9: please expand on the description of the cumulative constraint;
rather than depending on readers looking for the citation [19].

RESPONSE: Done. Please see section 3.2.2.

27) 12. Page 9, ³investigated a number of different dispatching heuristics²: 
I think it would be useful if you outline briefly the options that you tried but 
didn¹t work, maybe as a footnote.

RESPONSE: A brief description of the other heuristics is given in section 
          3.2.4, "A Dispatching Heuristic".

28) 13. Page 11: put in some intuitions behind selecting three different
policies to test (e.g., potential pros and cons of each option).

RESPONSE: Some intuitions are provided in section 3.3, "Rescheduling Strategy", 
          when the policies are introduced for the first time. A complete 
          discussion on their performance (potential pros and cons) is provided in 
          section 4.2.2.

29) 14. Figure 4: make it bigger to increase readability.

RESPONSE: Fixed.

30) 15. Page 12: put ³:² after leading words ³Aircraft², ³Waves², ³Trades²,
³Repair Jobs² (also for the rescheduling part)

RESPONSE: Fixed.

31) 16. Page 13: can you give more concrete comparison number for the cases 
³when the CP master can be solved within the time limit, Benders-CP 
is superior to the MIP²?

RESPONSE: We have use a more recent CP solver in the new version of the 
          paper (CP Optimizer). For the new comparison of MIP and 
          Benders-CP, please see section 4.1.2.

------------------------------------------------------------------------------------- 
Reviewer #3:
 
To summarize, this paper describes algorithms for solving a dynamic aircraft 
repair and scheduling problem.  The paper is intended to be an archival version of 
work that appeared previously in a conference and a workshop. The main extensions 
over the conference papers include a complexity result, generalization to dynamic 
settings, and more extensive experimental results.

The major contributions include the following

1. Bender's cut algorithms for solving the aircraft repair shop problem 
that improves the computational efficiency of existing approaches.
2. Demonstration that the algorithms can be used in a dynamic setting, 
where the algorithm is applied sequentially as new information arises. The 
approach gets better solutions than a classical heuristic often used in other 
scheduling domains.
3. NP-Hard proof for the aircraft repair problem.
4. A nice algorithm that combines MIP with CP.

The limitations of the manuscript include the following:

1. There are some questions about the appropriateness of the uncertainty 
model adopted in the paper and the use of "optimality" when referring to 
maximizing Z_kw under this model. 

In general, uncertainty is a computationally difficult task in optimization.  
The static model used in this paper addresses the computational 
difficulties by "optimizing with respect to the mean" of the uncertainty. This is 
seen in constraints 2 and 3 of Figure 3. In many cases this type of a model of uncertainty 
is appropriate; however, there are many cases where such an approach yields arbitrarily bad solutions 
(see the Birge and Louveaux text book on stochastic programming). This review does not 
quibble with the static model since the model already appears in the literature under 
references [32] and [33].  The authors make a strong contribution by introducing new 
hybrid algorithms for the static problem that are more computationally efficient than 
existing approaches.

1) However, as the authors are introducing a dynamic version of the problem, 
there at least needs to be a discussion on the potential limitations of the 
optimizing with respect to the mean in the dynamic setting (going back to the Birge 
and Louveaux text book). In other words, it is possible that an alternate 
optimization model (say a multi-stage stochastic program that moves the expectation 
out of the constraints and into the objective function or a dynamic 
programming approach, etc.) would yield better Z_kw in a dynamic setting.

To really strengthen the paper, results should be presented that suggest 
optimizing w.r.t the mean is a reasonable approach when 
applied to a dynamic setting when solving a sequence of static problems. 
The comparison with the heuristic is a good start, some other ideas include 
1) demonstrate that the uncertainty is "well-behaved" - e.g. has low variance 
2) do a sensitivity analysis on constraints 2 and 3 - so that the model 
assumes it has x% of the expected number of aircraft 
(where this multiplier could increase or decrease E_kw) - 
this gets closer to a robust optimization approach 
3) compare with a multi-stage approach (the expectation goes in the 
objective function) - this is likely to be hopelessly intractable on large problems, 
but maybe on very small problems a comparison could be achieved or 
4) Develop some bounds (even weak ones) on the best possible outcome 
for a dynamic algorithm.  In short, the reader only sees that this approach is 
better than a heuristic but there is no information on how much better one 
could potentially be in the dynamic setting.

RESPONSE: In section 4.2.2, considering some of reviewer's ideas, we have presented 
          the results to provide evidence for the soundness of modeling the uncertainty 
          in expectation. More specifically:
          
          1) We have compared the variance of the observed coverage in the 
          the long run using different scheduling and rescheduling techniques.
          2) In part "The impact of modeling the uncertainty in expectation", we have 
          done a sensitivity analysis on different values of the failure rates of the 
          aircraft to show that our solution approach can reasonably balance against 
          different uncertain scenarios.
          3) We have presented a new scheduling policy, called "Relaxed", to provide 
          an estimation of the upper bound on the achievable wave coverage in the 
          long term.
          
          We have addressed the limitation of our solution approach with 
          respect to modeling the uncertainty in expectation is section 5,
          "Discussion", and have provided ideas for dealing with this drawback.
          
2) 2. The results and algorithms are demonstrated on a very specific class of 
scheduling problems. Remarks on how to generalize to a broader class of 
scheduling problems would strengthen the paper.

RESPONSE: A paragraph is added in "Discussion" section to describe 
          how the algorithms can be extended to a broader class of 
          scheduling problems.


3) 3. In theorem 1, it is stated that there are |W| flights when reducing 
the 2D knapsack problem to the aircraft repair problem. |W| is not specified 
in the reduction.  What is it?

RESPONSE: The proof has changed and all the notation are described clearly.

4) 4. This reviewer is not convinved that the complexity result is complete. 
Looking back at reference [8], the statement is made that the 2D knapsack 
problem is NP-Hard because the special case of all items having equal 
height can be shown to be NP-Hard.  I am not sure if the problem remains NP-Hard 
when all profits are 1 as required by the proof.  Since the NP-Hardness proof 
discussed in [8] is only for the special case of uniform height, then the reduction 
is only valid for uniform heights (and uniform profits). I believe this particular 
problem reduces to a 1D knapsack where all profits are equal and only the weights 
vary, which I believe is polynomial solvable with a greedy algorithm.  
In which case, the authors need to show that the reduction works from a 
non-uniform profit 2D knapsack problem in order for the proof to be completely 
correct.  Or cite a reference that proves that the uniform profit with non-uniform 
heights and weights 2D knapsack problem is NP-Hard.

RESPONSE: We agree with the reviewer. The proof has been changed. 

5) 5. In section 3.2 it is stated that a pure CP approach does not perform well 
on this problem. More details should be provided, so that readers know what was 
tried and didn't work.  Was the model passed to a commercial solver with default 
settings, etc.?

RESPONSE: In the new version of the paper, we have included two new CP models 
          including a pure CP and we have provided enough information on how 
          each algorithm is implemented.

6) 6. The discussion on Figure 3 is missing details, and a number of aspects of the model 
have to be inferred.  For example, d_i is never explained.  This reviewer assumes this is 
the time at which the repair for job i is completed (a decision variable); however this reviewer 
did not see this explicitly stated anywhere.  The authors should look at this part of the paper 
and revise to ensure all the necessary details needed for understanding the model in 
Figure 3 are included.

RESPONSE: Fixed. Please see section 3.2.1.

7) 7. The distinction between Benders-MIP and Benders-MIP-T is never explained. 
Does "-T" refer to the time interval improvements of constraint 14?

RESPONSE: "T" stands for the "Tighter relaxation". It has been made explicit
         in the paper where introducing "Benders-MIP-T" for the first time.  

8) 8. On page 9, the authors suggest other dispatching heuristics were tried that 
didn't work. What were they?  This will help ensure readers do not try something 
that the authors have already determined does not work.

RESPONSE: A brief description of the other heuristic approaches 
          are provided in section 3.2.4.


9) 9. There has been some recent work on the static version of the problem that needs to 
be included in the literature review.

Kozanidis, Gavranis, and Kostarelou. "Mixed Integer Least Squares Optimization for Flight and 
Maintenance Planning of Mission Aircraft" Naval Research Logistics 59(3-4) pages 212-229, 2012.
 
RESPONSE: The mentioned work is added to the literature review. 
          Please see section 2.2.1.           
